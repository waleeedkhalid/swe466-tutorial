<!DOCTYPE html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Database View - Project Management System</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* Dark Theme (Default) */
      :root,
      [data-theme="dark"] {
        --bg: #0f1419;
        --bg-card: #1a1f26;
        --bg-hover: #242b33;
        --border: #2d3640;
        --text: #e7e9ea;
        --text-muted: #71767b;
        --primary: #1d9bf0;
        --primary-hover: #1a8cd8;
        --danger: #f4212e;
        --danger-hover: #dc1e28;
        --success: #00ba7c;
        --warning: #ffad1f;
        --radius: 12px;
        --code-bg: #161b22;
      }

      /* Light Theme */
      [data-theme="light"] {
        --bg: #f5f8fa;
        --bg-card: #ffffff;
        --bg-hover: #e8ecef;
        --border: #cfd9de;
        --text: #0f1419;
        --text-muted: #536471;
        --primary: #1d9bf0;
        --primary-hover: #1a8cd8;
        --danger: #f4212e;
        --danger-hover: #dc1e28;
        --success: #00ba7c;
        --warning: #ffad1f;
        --radius: 12px;
        --code-bg: #f6f8fa;
      }

      body {
        font-family: "DM Sans", -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: var(--bg);
        color: var(--text);
        min-height: 100vh;
        line-height: 1.5;
      }

      header {
        background: linear-gradient(
          135deg,
          var(--bg-card) 0%,
          var(--bg-hover) 100%
        );
        border-bottom: 1px solid var(--border);
        padding: 1.5rem 2rem;
        position: sticky;
        top: 0;
        z-index: 100;
        backdrop-filter: blur(12px);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      header h1 {
        font-size: 1.75rem;
        font-weight: 700;
        background: linear-gradient(135deg, var(--primary) 0%, #00d4aa 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      header h1 svg {
        width: 28px;
        height: 28px;
        color: var(--primary);
        -webkit-text-fill-color: initial;
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .back-link {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-muted);
        text-decoration: none;
        font-weight: 500;
        padding: 0.5rem 1rem;
        border-radius: 8px;
        transition: all 0.2s ease;
      }

      .back-link:hover {
        background: var(--bg-hover);
        color: var(--text);
      }

      .theme-toggle {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        background: var(--bg);
        border: 1px solid var(--border);
        border-radius: 50px;
        padding: 0.5rem 1rem;
      }

      .theme-switch {
        position: relative;
        width: 50px;
        height: 26px;
        background: var(--border);
        border-radius: 50px;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .theme-switch::before {
        content: "";
        position: absolute;
        top: 3px;
        left: 3px;
        width: 20px;
        height: 20px;
        background: var(--text);
        border-radius: 50%;
        transition: transform 0.3s ease;
      }

      [data-theme="light"] .theme-switch {
        background: var(--primary);
      }

      [data-theme="light"] .theme-switch::before {
        transform: translateX(24px);
      }

      main {
        max-width: 1400px;
        margin: 0 auto;
        padding: 2rem;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .stat-card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        padding: 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .stat-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .stat-icon.tasks {
        background: rgba(29, 155, 240, 0.15);
        color: var(--primary);
      }

      .stat-icon.resources {
        background: rgba(0, 186, 124, 0.15);
        color: var(--success);
      }

      .stat-icon.storage {
        background: rgba(255, 173, 31, 0.15);
        color: var(--warning);
      }

      .stat-icon svg {
        width: 24px;
        height: 24px;
      }

      .stat-info h3 {
        font-size: 1.75rem;
        font-weight: 700;
        color: var(--text);
      }

      .stat-info p {
        font-size: 0.875rem;
        color: var(--text-muted);
      }

      .card {
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        margin-bottom: 1.5rem;
        overflow: hidden;
      }

      .card-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1rem 1.5rem;
        border-bottom: 1px solid var(--border);
        background: var(--bg-hover);
      }

      .card-header h2 {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .card-header h2 svg {
        width: 20px;
        height: 20px;
        color: var(--primary);
      }

      .card-header .badge {
        background: var(--primary);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .card-body {
        padding: 1.5rem;
      }

      .json-view {
        background: var(--code-bg);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 1rem;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.875rem;
        overflow-x: auto;
        max-height: 400px;
        overflow-y: auto;
      }

      .json-key {
        color: #79c0ff;
      }

      .json-string {
        color: #a5d6ff;
      }

      .json-number {
        color: #56d364;
      }

      .json-boolean {
        color: #ff7b72;
      }

      .json-null {
        color: #8b949e;
      }

      .json-bracket {
        color: var(--text-muted);
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      th,
      td {
        padding: 0.875rem 1rem;
        text-align: left;
        border-bottom: 1px solid var(--border);
      }

      th {
        font-weight: 600;
        color: var(--text);
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        background: var(--bg-hover);
      }

      td {
        color: var(--text-muted);
        font-size: 0.875rem;
      }

      tr:hover td {
        background: var(--bg-hover);
      }

      .id-cell {
        font-family: "JetBrains Mono", monospace;
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .name-cell {
        color: var(--text);
        font-weight: 500;
      }

      .type-badge {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .type-badge.work {
        background: rgba(29, 155, 240, 0.15);
        color: var(--primary);
      }

      .type-badge.cost {
        background: rgba(0, 186, 124, 0.15);
        color: var(--success);
      }

      .resource-tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.25rem;
      }

      .resource-tag {
        background: rgba(29, 155, 240, 0.15);
        color: var(--primary);
        padding: 0.125rem 0.5rem;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 500;
      }

      .empty-state {
        text-align: center;
        padding: 3rem 1.5rem;
        color: var(--text-muted);
      }

      .empty-state svg {
        width: 48px;
        height: 48px;
        margin-bottom: 1rem;
        opacity: 0.5;
      }

      .timestamp {
        font-family: "JetBrains Mono", monospace;
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .refresh-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .refresh-btn:hover {
        background: var(--primary-hover);
        transform: translateY(-1px);
      }

      .refresh-btn svg {
        width: 16px;
        height: 16px;
      }

      .tabs {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
        background: var(--bg-card);
        padding: 0.5rem;
        border-radius: var(--radius);
        border: 1px solid var(--border);
      }

      .tab-btn {
        flex: 1;
        padding: 0.75rem 1rem;
        background: transparent;
        border: none;
        color: var(--text-muted);
        font-size: 0.875rem;
        font-weight: 600;
        cursor: pointer;
        border-radius: 8px;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .tab-btn:hover {
        background: var(--bg-hover);
        color: var(--text);
      }

      .tab-btn.active {
        background: var(--primary);
        color: white;
      }

      .tab-btn svg {
        width: 18px;
        height: 18px;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .data-actions {
        display: flex;
        gap: 0.5rem;
        margin-top: 1rem;
      }

      .btn-secondary {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: var(--bg-hover);
        color: var(--text);
        border: 1px solid var(--border);
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .btn-secondary:hover {
        background: var(--border);
      }

      .btn-secondary svg {
        width: 16px;
        height: 16px;
      }

      .btn-danger {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: var(--danger);
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .btn-danger:hover {
        background: var(--danger-hover);
      }

      .btn-danger svg {
        width: 16px;
        height: 16px;
      }

      .toast {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        padding: 1rem 1.5rem;
        background: var(--bg-card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        z-index: 1000;
        animation: slideIn 0.3s ease, slideOut 0.3s ease 2.7s;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .toast.success {
        border-left: 4px solid var(--success);
      }

      .toast.error {
        border-left: 4px solid var(--danger);
      }

      @keyframes slideIn {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      @keyframes slideOut {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(100%);
          opacity: 0;
        }
      }

      @media (max-width: 768px) {
        .stats-grid {
          grid-template-columns: 1fr;
        }

        .tabs {
          flex-wrap: wrap;
        }

        .tab-btn {
          flex: 1 1 calc(50% - 0.25rem);
        }

        table {
          font-size: 0.75rem;
        }

        th,
        td {
          padding: 0.5rem;
        }

        .header-actions {
          flex-direction: column;
          gap: 0.5rem;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="header-left">
        <h1>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"
            />
          </svg>
          Database View
        </h1>
      </div>
      <div class="header-actions">
        <a href="index.html" class="back-link">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 19l-7-7m0 0l7-7m-7 7h18"
            />
          </svg>
          Back to App
        </a>
        <div class="theme-toggle">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            style="color: var(--text-muted)"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
            />
          </svg>
          <div
            class="theme-switch"
            id="themeSwitch"
            onclick="toggleTheme()"
          ></div>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            style="color: var(--text-muted)"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"
            />
          </svg>
        </div>
      </div>
    </header>

    <main>
      <!-- Stats Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-icon tasks">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
              />
            </svg>
          </div>
          <div class="stat-info">
            <h3 id="taskCount">0</h3>
            <p>Total Tasks</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon resources">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
              />
            </svg>
          </div>
          <div class="stat-info">
            <h3 id="resourceCount">0</h3>
            <p>Total Resources</p>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-icon storage">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"
              />
            </svg>
          </div>
          <div class="stat-info">
            <h3 id="storageSize">0 B</h3>
            <p>Storage Used</p>
          </div>
        </div>
      </div>

      <!-- View Tabs -->
      <div class="tabs">
        <button class="tab-btn active" data-tab="table-view">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"
            />
          </svg>
          Table View
        </button>
        <button class="tab-btn" data-tab="json-view">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"
            />
          </svg>
          Raw JSON
        </button>
        <button class="tab-btn" data-tab="schema-view">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"
            />
          </svg>
          Schema
        </button>
      </div>

      <!-- Table View -->
      <div id="table-view" class="tab-content active">
        <!-- Tasks Table -->
        <div class="card">
          <div class="card-header">
            <h2>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                />
              </svg>
              pms_tasks
            </h2>
            <span class="badge" id="tasksBadge">0 records</span>
          </div>
          <div class="card-body" style="padding: 0">
            <div style="overflow-x: auto">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Task Name</th>
                    <th>Duration</th>
                    <th>Start Date</th>
                    <th>Finish Date</th>
                    <th>Resources</th>
                    <th>Created At</th>
                    <th>Updated At</th>
                  </tr>
                </thead>
                <tbody id="tasksTableBody"></tbody>
              </table>
            </div>
            <div id="tasksEmpty" class="empty-state" style="display: none">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                />
              </svg>
              <p>No tasks in database</p>
            </div>
          </div>
        </div>

        <!-- Resources Table -->
        <div class="card">
          <div class="card-header">
            <h2>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
                />
              </svg>
              pms_resources
            </h2>
            <span class="badge" id="resourcesBadge">0 records</span>
          </div>
          <div class="card-body" style="padding: 0">
            <div style="overflow-x: auto">
              <table>
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Resource Name</th>
                    <th>Type</th>
                    <th>Max Units</th>
                    <th>St. Rate</th>
                    <th>Cost/Use</th>
                    <th>Created At</th>
                    <th>Updated At</th>
                  </tr>
                </thead>
                <tbody id="resourcesTableBody"></tbody>
              </table>
            </div>
            <div id="resourcesEmpty" class="empty-state" style="display: none">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
                />
              </svg>
              <p>No resources in database</p>
            </div>
          </div>
        </div>
      </div>

      <!-- JSON View -->
      <div id="json-view" class="tab-content">
        <div class="card">
          <div class="card-header">
            <h2>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                />
              </svg>
              pms_tasks (Raw JSON)
            </h2>
            <button class="refresh-btn" onclick="copyToClipboard('tasks')">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"
                />
              </svg>
              Copy
            </button>
          </div>
          <div class="card-body">
            <pre class="json-view" id="tasksJson"></pre>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
                />
              </svg>
              pms_resources (Raw JSON)
            </h2>
            <button class="refresh-btn" onclick="copyToClipboard('resources')">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"
                />
              </svg>
              Copy
            </button>
          </div>
          <div class="card-body">
            <pre class="json-view" id="resourcesJson"></pre>
          </div>
        </div>

        <div class="data-actions">
          <button class="btn-secondary" onclick="exportData()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"
              />
            </svg>
            Export All Data
          </button>
          <button class="btn-danger" onclick="clearAllData()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
              />
            </svg>
            Clear All Data
          </button>
        </div>
      </div>

      <!-- Schema View -->
      <div id="schema-view" class="tab-content">
        <div class="card">
          <div class="card-header">
            <h2>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                />
              </svg>
              Tasks Schema
            </h2>
          </div>
          <div class="card-body" style="padding: 0">
            <table>
              <thead>
                <tr>
                  <th>Field</th>
                  <th>Type</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="name-cell">id</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Unique identifier (timestamp-based)</td>
                </tr>
                <tr>
                  <td class="name-cell">taskName</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Name of the task</td>
                </tr>
                <tr>
                  <td class="name-cell">duration</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Duration of the task (e.g., "5 days")</td>
                </tr>
                <tr>
                  <td class="name-cell">startDate</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Start date (YYYY-MM-DD format)</td>
                </tr>
                <tr>
                  <td class="name-cell">finishDate</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Finish date (YYYY-MM-DD format)</td>
                </tr>
                <tr>
                  <td class="name-cell">resourceNames</td>
                  <td><span class="type-badge cost">array</span></td>
                  <td>Array of allocated resource names</td>
                </tr>
                <tr>
                  <td class="name-cell">createdAt</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>ISO timestamp of creation</td>
                </tr>
                <tr>
                  <td class="name-cell">updatedAt</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>ISO timestamp of last update</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <h2>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"
                />
              </svg>
              Resources Schema
            </h2>
          </div>
          <div class="card-body" style="padding: 0">
            <table>
              <thead>
                <tr>
                  <th>Field</th>
                  <th>Type</th>
                  <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="name-cell">id</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Unique identifier (timestamp-based)</td>
                </tr>
                <tr>
                  <td class="name-cell">resourceName</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Name of the resource</td>
                </tr>
                <tr>
                  <td class="name-cell">type</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Type of resource ("Work" or "Cost")</td>
                </tr>
                <tr>
                  <td class="name-cell">max</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Maximum units (e.g., "100%")</td>
                </tr>
                <tr>
                  <td class="name-cell">stRate</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Standard hourly rate (e.g., "15$/hr")</td>
                </tr>
                <tr>
                  <td class="name-cell">costPerUse</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>Fixed cost per use</td>
                </tr>
                <tr>
                  <td class="name-cell">createdAt</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>ISO timestamp of creation</td>
                </tr>
                <tr>
                  <td class="name-cell">updatedAt</td>
                  <td><span class="type-badge work">string</span></td>
                  <td>ISO timestamp of last update</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </main>

    <script>
      // ==========================================
      // THEME MANAGEMENT
      // ==========================================
      function toggleTheme() {
        const html = document.documentElement;
        const currentTheme = html.getAttribute("data-theme");
        const newTheme = currentTheme === "dark" ? "light" : "dark";
        html.setAttribute("data-theme", newTheme);
        localStorage.setItem("pms_theme", newTheme);
      }

      function initTheme() {
        const savedTheme = localStorage.getItem("pms_theme") || "dark";
        document.documentElement.setAttribute("data-theme", savedTheme);
      }

      initTheme();

      // ==========================================
      // TAB NAVIGATION
      // ==========================================
      document.querySelectorAll(".tab-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          document
            .querySelectorAll(".tab-btn")
            .forEach((b) => b.classList.remove("active"));
          document
            .querySelectorAll(".tab-content")
            .forEach((c) => c.classList.remove("active"));
          btn.classList.add("active");
          document.getElementById(btn.dataset.tab).classList.add("active");
        });
      });

      // ==========================================
      // DATA LOADING
      // ==========================================
      function loadData() {
        const tasks = JSON.parse(localStorage.getItem("pms_tasks") || "[]");
        const resources = JSON.parse(
          localStorage.getItem("pms_resources") || "[]"
        );

        // Update stats
        document.getElementById("taskCount").textContent = tasks.length;
        document.getElementById("resourceCount").textContent = resources.length;
        document.getElementById(
          "tasksBadge"
        ).textContent = `${tasks.length} records`;
        document.getElementById(
          "resourcesBadge"
        ).textContent = `${resources.length} records`;

        // Calculate storage size
        const tasksSize = new Blob([JSON.stringify(tasks)]).size;
        const resourcesSize = new Blob([JSON.stringify(resources)]).size;
        const totalSize = tasksSize + resourcesSize;
        document.getElementById("storageSize").textContent =
          formatBytes(totalSize);

        // Render tables
        renderTasksTable(tasks);
        renderResourcesTable(resources);

        // Render JSON
        renderJSON(tasks, resources);
      }

      function formatBytes(bytes) {
        if (bytes === 0) return "0 B";
        const k = 1024;
        const sizes = ["B", "KB", "MB"];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + " " + sizes[i];
      }

      function formatTimestamp(isoString) {
        if (!isoString) return "-";
        const date = new Date(isoString);
        return date.toLocaleString("en-US", {
          month: "short",
          day: "numeric",
          year: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      function renderTasksTable(tasks) {
        const tbody = document.getElementById("tasksTableBody");
        const empty = document.getElementById("tasksEmpty");

        if (tasks.length === 0) {
          tbody.innerHTML = "";
          empty.style.display = "block";
          return;
        }

        empty.style.display = "none";
        tbody.innerHTML = tasks
          .map(
            (task) => `
          <tr>
            <td class="id-cell">${task.id}</td>
            <td class="name-cell">${task.taskName}</td>
            <td>${task.duration}</td>
            <td>${task.startDate}</td>
            <td>${task.finishDate}</td>
            <td>
              ${
                task.resourceNames && task.resourceNames.length > 0
                  ? `<div class="resource-tags">${task.resourceNames
                      .map((r) => `<span class="resource-tag">${r}</span>`)
                      .join("")}</div>`
                  : "-"
              }
            </td>
            <td class="timestamp">${formatTimestamp(task.createdAt)}</td>
            <td class="timestamp">${formatTimestamp(task.updatedAt)}</td>
          </tr>
        `
          )
          .join("");
      }

      function renderResourcesTable(resources) {
        const tbody = document.getElementById("resourcesTableBody");
        const empty = document.getElementById("resourcesEmpty");

        if (resources.length === 0) {
          tbody.innerHTML = "";
          empty.style.display = "block";
          return;
        }

        empty.style.display = "none";
        tbody.innerHTML = resources
          .map(
            (resource) => `
          <tr>
            <td class="id-cell">${resource.id}</td>
            <td class="name-cell">${resource.resourceName}</td>
            <td><span class="type-badge ${resource.type.toLowerCase()}">${
              resource.type
            }</span></td>
            <td>${resource.max || "-"}</td>
            <td>${resource.stRate || "-"}</td>
            <td>${resource.costPerUse || "-"}</td>
            <td class="timestamp">${formatTimestamp(resource.createdAt)}</td>
            <td class="timestamp">${formatTimestamp(resource.updatedAt)}</td>
          </tr>
        `
          )
          .join("");
      }

      function syntaxHighlight(json) {
        if (typeof json !== "string") {
          json = JSON.stringify(json, null, 2);
        }
        json = json
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;");
        return json.replace(
          /("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,
          function (match) {
            let cls = "json-number";
            if (/^"/.test(match)) {
              if (/:$/.test(match)) {
                cls = "json-key";
              } else {
                cls = "json-string";
              }
            } else if (/true|false/.test(match)) {
              cls = "json-boolean";
            } else if (/null/.test(match)) {
              cls = "json-null";
            }
            return '<span class="' + cls + '">' + match + "</span>";
          }
        );
      }

      function renderJSON(tasks, resources) {
        document.getElementById("tasksJson").innerHTML = syntaxHighlight(
          JSON.stringify(tasks, null, 2)
        );
        document.getElementById("resourcesJson").innerHTML = syntaxHighlight(
          JSON.stringify(resources, null, 2)
        );
      }

      // ==========================================
      // UTILITY FUNCTIONS
      // ==========================================
      function showToast(message, type = "success") {
        const toast = document.createElement("div");
        toast.className = `toast ${type}`;
        toast.innerHTML = `
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            ${
              type === "success"
                ? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>'
                : '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>'
            }
          </svg>
          ${message}
        `;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
      }

      function copyToClipboard(type) {
        const data =
          localStorage.getItem(
            type === "tasks" ? "pms_tasks" : "pms_resources"
          ) || "[]";
        navigator.clipboard
          .writeText(JSON.stringify(JSON.parse(data), null, 2))
          .then(() => {
            showToast("Copied to clipboard!");
          });
      }

      function exportData() {
        const tasks = localStorage.getItem("pms_tasks") || "[]";
        const resources = localStorage.getItem("pms_resources") || "[]";
        const data = {
          exportDate: new Date().toISOString(),
          tasks: JSON.parse(tasks),
          resources: JSON.parse(resources),
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `pms-data-export-${
          new Date().toISOString().split("T")[0]
        }.json`;
        a.click();
        URL.revokeObjectURL(url);
        showToast("Data exported successfully!");
      }

      function clearAllData() {
        if (
          !confirm(
            "Are you sure you want to clear all data? This action cannot be undone."
          )
        )
          return;
        localStorage.removeItem("pms_tasks");
        localStorage.removeItem("pms_resources");
        loadData();
        showToast("All data cleared!");
      }

      // ==========================================
      // INITIALIZATION
      // ==========================================
      loadData();

      // Auto-refresh every 2 seconds to catch changes from the main app
      setInterval(loadData, 2000);
    </script>
  </body>
</html>
